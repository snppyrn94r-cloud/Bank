let saldo = parseInt(localStorage.getItem("saldo")) || 5000000;
let riwayat = JSON.parse(localStorage.getItem("riwayat")) || [];

function showScreen(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function login() {
  const name = document.getElementById("usernameInput").value;
  localStorage.setItem("username", name);
  document.getElementById("username").innerText = "Halo, " + name;
  updateSaldo();
  showScreen("home");
}

function logout() {
  showScreen("login");
}

function updateSaldo() {
  document.getElementById("saldoText").innerText = "Rp " + saldo.toLocaleString("id-ID");
  localStorage.setItem("saldo", saldo);
}

function doTransfer() {
  const nominal = parseInt(document.getElementById("nominal").value);
  const rek = document.getElementById("rekTujuan").value;

  if (!rek || !nominal) {
    alert("Lengkapi data transfer");
    return;
  }

  if (nominal > saldo) {
    alert("Saldo tidak cukup");
    return;
  }

  saldo -= nominal;
  riwayat.unshift(`Transfer Rp ${nominal.toLocaleString("id-ID")} ke ${rek}`);
  localStorage.setItem("riwayat", JSON.stringify(riwayat));

  updateSaldo();
  alert("Transfer berhasil");
  showScreen("home");
}

function loadRiwayat() {
  const list = document.getElementById("riwayatList");
  list.innerHTML = "";
  riwayat.forEach(item => {
    const li = document.createElement("li");
    li.innerText = item;
    list.appendChild(li);
  });
}

document.addEventListener("click", () => {
  if (document.getElementById("riwayat").classList.contains("active")) {
    loadRiwayat();
  }
});
